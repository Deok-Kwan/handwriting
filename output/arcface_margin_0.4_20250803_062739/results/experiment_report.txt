
ArcFace MIL Experiment Report
=============================
Experiment ID: arcface_margin_0.4_20250803_062739
Timestamp: 20250803_062831
Model: AB_MIL with ArcFace embeddings (256d)

Optimization Strategy (학습 안정성 향상):
- Optimizer: AdamW (weight_decay=0.0001)
- Scheduler: OneCycleLR
  - Warm-up: 1e-05 → 1e-04 (10% epochs)
  - Annealing: 1e-04 → 1e-06
- 목적: 초기 gradient 폭발 방지, 안정적 수렴

Validation Strategy (분포 편향 방지):
- Early Stopping: Balanced F1 (빠른 학습 모니터링)
- Threshold Calc: Natural distribution (정확한 threshold)
- 목적: 균형잡힌 validation이 실제 test 성능에 미치는 편향 제거

Configuration:
- Batch size: 64
- Learning rate: 1e-05 → 1e-04 → 1e-06
- Positive weight: 1.0
- Epochs trained: 9

Best Validation Performance:
- F1 Score (Balanced): 0.6599
- Optimal Threshold (Natural): 0.4972

Test Set Performance:
- Accuracy: 0.6532
- Precision: 0.7116
- Recall: 0.8069
- F1 Score: 0.7563
- AUC: 0.6354

Performance by Difficulty:

ratio_0.0: F1=0.000, Recall=0.000 (n=1440)
ratio_0.05: F1=0.838, Recall=0.721 (n=720)
ratio_0.1: F1=0.861, Recall=0.756 (n=720)
ratio_0.2: F1=0.903, Recall=0.824 (n=720)
ratio_0.3: F1=0.963, Recall=0.928 (n=720)