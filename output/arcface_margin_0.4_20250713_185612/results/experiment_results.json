{
  "experiment": "AB_MIL_ArcFace_256d",
  "experiment_id": "arcface_margin_0.4_20250713_185612",
  "timestamp": "20250713_185942",
  "config": {
    "bags_root": "/workspace/MIL/data/processed/bags",
    "tag": "arcface_margin_0.4",
    "experiment_id": "arcface_margin_0.4_20250713_185612",
    "output_root": "/workspace/MIL/output/arcface_margin_0.4_20250713_185612",
    "model_dir": "/workspace/MIL/output/arcface_margin_0.4_20250713_185612/models",
    "figure_dir": "/workspace/MIL/output/arcface_margin_0.4_20250713_185612/figures",
    "result_dir": "/workspace/MIL/output/arcface_margin_0.4_20250713_185612/results",
    "batch_size": 64,
    "num_workers": 8,
    "epochs": 40,
    "lr_start": 1e-05,
    "lr_max": 0.0001,
    "lr_final": 1e-06,
    "scheduler": "OneCycleLR",
    "warmup_pct": 0.1,
    "weight_decay": 0.0001,
    "pos_weight": 1.0,
    "early_stop_patience": 4,
    "early_stop_delta": 0.002,
    "inst_dim": 256,
    "win_len": 5,
    "block_len": 10,
    "attn_hidden": 128
  },
  "validation_strategy": {
    "early_stopping": "Balanced F1 (\ube60\ub978 \ubaa8\ub2c8\ud130\ub9c1)",
    "threshold_calc": "Natural distribution (\ud3b8\ud5a5 \ubc29\uc9c0)",
    "description": "\uc774\uc911 \uac80\uc99d\uc73c\ub85c \ubd84\ud3ec \ud3b8\ud5a5 \ubb38\uc81c \ud574\uacb0"
  },
  "optimizer_strategy": {
    "optimizer": "AdamW",
    "scheduler": "OneCycleLR",
    "warmup_epochs": 4.0,
    "description": "Warm-up\uc73c\ub85c \ucd08\uae30 \ud559\uc2b5 \uc548\uc815\uc131 \ud655\ubcf4"
  },
  "best_threshold": 0.4954879581928253,
  "best_f1_val": 0.6409495548961426,
  "epochs_trained": 8,
  "test_metrics": {
    "ACC": 0.6976388888888889,
    "PREC": 0.8314523589269195,
    "REC": 0.7802083333333333,
    "F1": 0.8050156739811911,
    "AUC": 0.6307726900077161
  },
  "history": [
    {
      "F1": 0.5416949152542374,
      "PREC": 0.5291390728476821,
      "REC": 0.5548611111111111,
      "AUC": 0.538445457175926,
      "THR": 0.48187461495399475,
      "LR": 9.999999999999999e-06
    },
    {
      "F1": 0.566520714045133,
      "PREC": 0.5500327011118378,
      "REC": 0.5840277777777778,
      "AUC": 0.5735947145061728,
      "THR": 0.48629945516586304,
      "LR": 2.3226594504349108e-05
    },
    {
      "F1": 0.6124464932499176,
      "PREC": 0.5823418910457107,
      "REC": 0.6458333333333334,
      "AUC": 0.6152645158179012,
      "THR": 0.4917694926261902,
      "LR": 5.513114236484185e-05
    },
    {
      "F1": 0.6409495548961426,
      "PREC": 0.6101694915254238,
      "REC": 0.675,
      "AUC": 0.6463937114197531,
      "THR": 0.4954879581928253,
      "LR": 8.695859836390773e-05
    },
    {
      "F1": 0.6398625429553264,
      "PREC": 0.6333333333333333,
      "REC": 0.6465277777777778,
      "AUC": 0.660089699074074,
      "THR": 0.4989161193370819,
      "LR": 9.999998956403322e-05
    },
    {
      "F1": 0.6077957916522939,
      "PREC": 0.6038382453735435,
      "REC": 0.6118055555555556,
      "AUC": 0.633288242669753,
      "THR": 0.5039255619049072,
      "LR": 9.98071006374789e-05
    },
    {
      "F1": 0.5852631578947368,
      "PREC": 0.5914893617021276,
      "REC": 0.5791666666666667,
      "AUC": 0.61266902970679,
      "THR": 0.515796959400177,
      "LR": 9.923553013091457e-05
    },
    {
      "F1": 0.5993265993265995,
      "PREC": 0.5816993464052288,
      "REC": 0.6180555555555556,
      "AUC": 0.6061294367283951,
      "THR": 0.529417097568512,
      "LR": 9.828962804101888e-05
    }
  ],
  "difficulty_performance": {
    "ratio_0.0": {
      "count": 1440,
      "f1": 0.0,
      "recall": 0.0,
      "precision": 0.0,
      "accuracy": 0.36736111111111114
    },
    "ratio_0.05": {
      "count": 1440,
      "f1": 0.830694275274056,
      "recall": 0.7104166666666667,
      "precision": 1.0,
      "accuracy": 0.7104166666666667
    },
    "ratio_0.1": {
      "count": 1440,
      "f1": 0.8325901905147953,
      "recall": 0.7131944444444445,
      "precision": 1.0,
      "accuracy": 0.7131944444444445
    },
    "ratio_0.2": {
      "count": 1440,
      "f1": 0.8935843257779484,
      "recall": 0.8076388888888889,
      "precision": 1.0,
      "accuracy": 0.8076388888888889
    },
    "ratio_0.3": {
      "count": 1440,
      "f1": 0.9415656008820286,
      "recall": 0.8895833333333333,
      "precision": 1.0,
      "accuracy": 0.8895833333333333
    }
  }
}