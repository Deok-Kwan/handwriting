복수 필체 문서 분석 연구 요약 및 향후 계획
연구 배경 및 필요성
법의학 분야에서 문서 위조 여부와 작성자 식별은 매우 중요한 문제입니다. 유언장, 계약서, 진술서와 같이 법적 효력이 있는 문서에서 필적 위조가 발생하면 개인의 권리 침해나 사회적 혼란을 초래할 수 있습니다. 현재까지 이러한 필적 감정은 주로 전문가의 육안 비교에 의존해왔습니다. 그러나 사람에 의한 분석은 시간과 비용이 많이 들고, 완전한 객관성을 보장하기 어렵다는 한계가 있습니다. 특히 한 문서에 여러 사람의 필적이 섞인 복수 필체 상황(예: 공동 작성 계약서, 누군가 일부 내용을 수정한 문서 등)에서는, 어떤 부분을 누가 썼는지 구분하고 위조 여부를 판단하는 작업이 전문가에게도 매우 까다롭습니다.
이러한 배경에서 본 연구는 딥러닝을 활용하여 문서 내 복수 필체를 자동으로 식별하고 위조를 판별하는 시스템을 개발하고자 합니다. 하지만 현실적으로 문서의 부분별 작성자 레이블을 얻기는 어렵기 때문에, 개별 단어나 문장 단위로 정답을 주지 않고 문서 전체 단위 레이블(예: 위조문서 여부)만으로 학습하는 약지도 학습 기법이 필요합니다[1]. 작은 부분(문서의 5~30%)만 다른 사람이 쓴 경우에도 이를 탐지해내는 섬세함과, 학습에 사용되지 않은 새로운 작성자에 대해서도 잘 일반화할 수 있는 능력이 요구됩니다[1].
연구 방법: 3단계 MIL 파이프라인
본 연구에서는 Multiple Instance Learning (MIL) 프레임워크를 도입하여 복수 필체 문서를 분석합니다. 전체 시스템은 3단계 파이프라인으로 구성되어 있습니다[2]:
Stage 1: 필적 특징 추출 (ArcFace 임베딩)
개별 단어 이미지로부터 필적의 고유한 특징을 벡터로 추출하는 단계입니다. Vision Transformer 백본 모델에 ArcFace Loss를 적용하여 학습함으로써, 동일 작성자의 글씨는 인접하게, 다른 작성자의 글씨는 멀리 떨어진 임베딩 공간을 구성했습니다[2]. 이렇게 학습된 임베딩은 차원수가 256인 벡터이며, 총 300명의 필체(훈련 180명, 검증 60명, 테스트 60명)에 대해 훈련 데이터 약 20만 장 규모로 특징을 추출했습니다[3]. 이 단계 결과로 각 단어 이미지가 256차원 벡터로 표현되어 다음 단계 MIL의 입력으로 사용됩니다.
Stage 2: MIL Bag 데이터 생성 (문서 구성 및 위조 시뮬레이션)
Stage 1에서 얻은 단어 임베딩들을 이용해 문서 단위의 Bag 데이터를 구성합니다. 하나의 Bag이 한 문서를 의미하며, 각 Bag은 여러 개의 Instance로 이루어집니다. 여기서 Instance는 문서 내 연속된 5개 단어로 정의하여, 슬라이딩 윈도우 방식으로 추출했습니다[4][5]. 하나의 문서는 총 10개의 Instance(5개 단어씩 * 10창)로 구성되도록 했습니다[6]. 이렇게 생성된 Bag에는 문서 전체에 대한 레이블만 부여되고(단일 작성자 문서=0, 복수 작성자 문서=1), 개별 Instance에 대한 레이블은 사용하지 않는 MIL 환경으로 학습하게 됩니다.
Baseline 데이터 생성 방식: 복수 필체 문서를 시뮬레이션하기 위해 두 명의 작성자 필적을 한 문서에 섞었습니다. 베이스라인 방법(stage2_baseline.ipynb)에서는 한 작성자의 단어 7개와 다른 작성자의 단어 7개를 무작위로 섞어 14개 단어짜리 문서를 만들고[7], 이를 5-단어 슬라이딩 윈도우로 쪼개 Instance를 생성했습니다. 이 방식에서는 하나의 Instance(5개 단어 묶음) 안에도 두 작성자의 글씨가 혼합되는 경우가 생깁니다[7]. 한편 단일 필체 문서(진본 문서)의 경우에는 한 사람의 단어 14개로 문서를 구성하여 동일한 방식으로 Instance를 얻었습니다[7]. 전체 데이터셋 구성 시 진본 문서와 위조 문서 비율을 50:50으로 맞춰 학습 및 평가의 균형을 유지했습니다[7].
개선된 데이터 생성 방식: Instance 단위에서 혼합을 피하고자, 개선 버전(stage2_baseline-positiveBag_fixed.ipynb)에서는 윈도우의 순수성을 보장하도록 설계했습니다. 즉, 위조 문서의 경우 작성자 A의 연속 단어들로 이루어진 윈도우 5개와 작성자 B의 연속 단어들로 이루어진 윈도우 5개를 만들어 합침으로써, 각각의 Instance에는 오직 한 사람의 글씨만 포함되도록 했습니다[7]. 이렇게 모든 Instance가 단일 작성자의 필적으로만 구성되게 함으로써 혼합 윈도우 문제를 해결했습니다[7]. 마찬가지로 진본 문서는 한 작성자의 14개 단어로 구성하여 10개 Instance를 얻고, 데이터셋은 여전히 50%:50% 비율로 구성했습니다[7].
위와 같은 방식을 통해 대규모 MIL 학습용 데이터셋을 구축했습니다. 최종적으로 Train 약 3600개, Val 1200개, Test 1200개의 Bag을 생성하였으며, 각 Bag에는 메타데이터로 해당 문서의 작성자 ID 목록과 Instance들의 작성자 구성 정보도 기록해 두어 데이터 무결성을 검증했습니다[8]. 이러한 MIL 데이터 구성은 실제 상황의 복수 필체 문서를 모사하며, Instance별 레이블 없이도 MIL 모델이 학습할 수 있는 토대를 제공합니다.
Stage 3: MIL 모델 학습 및 비교 평가
MIL용으로 준비된 Bag 데이터를 입력으로 하여, 문서 단위 위조 탐지 분류 모델들을 학습하고 성능을 평가했습니다. 기본 모델로는 Attention 기반 MIL 모델을 구현하였습니다[9][10]. 이 모델은 각 Instance 임베딩(5개 단어의 평균)을 은닉 공간에 투영한 후, 학습된 Attention 값을 가중치로 주어 Instance들을 가중 합산하여 문서 단위 예측을 산출합니다[11][12]. 손실 함수는 위조 문서에 더 가중치를 부여하는 가중 BCE를 사용하고, 정확도뿐만 아니라 AUC, F1-score 등도 평가 지표로 사용했습니다.
또한 다양한 MIL 아키텍처를 비교 실험했습니다. 구현하여 시험한 모델들로는 기본 Attention MIL, Gated-Attention MIL, Transformer 기반 MIL, 평균 풀링 (Mean Pooling) 베이스라인, 그리고 DSMIL 등이 있습니다. DSMIL은 Attention 결과와 Max-pooling 결과를 결합하는 Dual-Stream MIL 모델로서, MIL 모델의 성능 향상을 위해 고안된 기법입니다[13]. 각 모델을 동일한 조건(동일 데이터, 하이퍼파라미터와 학습 전략) 하에서 학습시켜 성능을 비교하였습니다[14].
실험 결과 및 분석
모델 성능 비교: 여러 MIL 모델 중 DSMIL 모델이 가장 우수한 성능을 보였습니다. 예를 들어 기본 Attention MIL 모델의 테스트 AUC가 약 0.838인 반면, DSMIL 모델은 약 0.871의 AUC를 달성하여 약 4%p 높은 성능 향상을 나타냈습니다[15]. 최종 평가에서 DSMIL이 모든 모델 중 최고 성능을 기록했으며, F1 점수 기준으로도 DSMIL (F1≈0.79)이 Attention 기반 모델 (F1≈0.77)을 앞섰습니다[16]. 반면에 Instance들의 정보를 활용하지 않는 단순 평균 풀링 모델의 성능은 AUC 약 0.50으로 거의 무작위 수준에 그쳐, MIL 아키텍처의 중요성을 보여주었습니다[17].
위조 탐지 성능 분석: 학습된 모델은 진본 문서와 위조 문서를 높은 정확도로 구분해냈습니다. 특히 위조 문서 내부에 섞인 다른 작성자의 비율이 높을수록 탐지가 더 용이하여 성능이 향상되는 경향을 보였습니다[18]. 예를 들어 한 문서의 30%가 다른 사람 글씨로 위조된 경우 F1-score가 0.96에 달했으며, 단 5%만 위조된 아주 미량 혼입 상황에서도 F1-score 약 0.84 수준으로 위조를 잡아냈습니다[18]. 진본 문서(0% 위조)에 대해서는 위양성 없이 정확히 음성으로 예측하여 F1=0으로 표시되었고, 이는 위조 여부에 대한 모델의 보수적 탐지가 적절히 이루어졌음을 의미합니다[19]. 또한 Attention 기반 모델의 가중치 분포를 들여다본 결과, 단일 필체 문서의 경우 모든 Instance에 고르게 주목(attention)이 분산된 반면, 복수 필체 문서의 경우 특정 Instance에 높은 attention이 집중되는 패턴을 보였습니다[20]. 이는 모델이 문서 내에서 의심스러운 필체 부분을 스스로 포착하고 있음을 시사합니다.
향후 연구 방향 (후속 연구 제안)
본 연구의 결과를 바탕으로, 다음과 같은 향후 연구 및 개선 방향을 제안합니다:
데이터 측면 강화: 현재는 두 명의 작성자가 섞인 위조만 가정했지만, 앞으로는 더 다양한 위조 패턴의 시뮬레이션이 필요합니다[21]. 예를 들어, 위조 부분이 문서의 앞부분/뒷부분에 치우친 경우, 여러 명의 필체가 섞이는 경우 등 다양한 시나리오의 데이터를 생성하여 모델의 범용성을 높일 수 있습니다. 또한 실제 위조 문서 사례를 수집하여 모델을 검증하고 학습에 일부 활용함으로써 현실 적용 성능을 향상시키는 것도 중요합니다[21].
모델 측면 개선: MIL 모델의 구조를 한층 발전시킬 여지가 있습니다. Transformer 기반의 MIL 아키텍처를 도입하면 self-attention 메커니즘을 통해 Instance 간 복잡한 상호관계를 더 잘 포착할 수 있을 것으로 기대됩니다[22]. 또한 멀티-스케일 어텐션 등 한 문서 내 패턴을 다양한 규모에서 바라보는 기법을 적용해 성능을 높일 수 있습니다[22]. 나아가, 현재는 위조 여부를 이진 분류했지만 추후에는 특정 작성자들의 필적 포함 여부를 예측하는 다중 분류 MIL로 확장하거나, Instance 단위의 예측을 통해 어느 부분이 어느 작성자의 필적인지까지 식별하는 방향으로 발전시킬 수 있습니다.
실용화 및 응용: 연구 수준을 넘어 실제 활용을 위해서는 몇 가지 추가 고려가 필요합니다. 한국어 필기체 데이터를 활용하거나 글자 단위 OCR을 결합하여 다양한 언어에 적용할 수 있는지 검토해야 합니다[23]. 또한 필드에서 사용할 수 있도록 모델 경량화 및 최적화를 통해 실시간 처리에 가까운 성능을 내는 것도 과제로 남아 있습니다[23]. 최종적으로는 법의학 현장에서 본 시스템이 전문가의 판단을 보조하거나 자동으로 1차 선별을 수행할 수 있도록 신뢰성과 사용성을 확보하는 방향으로 나아가야 할 것입니다.
以上와 같이, ArcFace 임베딩 기반 MIL 파이프라인을 통해 복수 필체 문서에서도 자동으로 위조를 탐지하는 가능성을 확인하였습니다. 향후 데이터 확충과 모델 고도화를 통해 더욱 정교하고 실용적인 필적 위조 판별 시스템으로 발전시킬 수 있을 것으로 기대합니다. [15][18]

