# CRAFT 텍스트 감지 기반 MIL 패치 추출기

## 구현 기능 요약

이 구현은 다음 기능을 제공합니다:

1. CRAFT 텍스트 감지 모델을 사용해 문서 이미지에서 텍스트 영역을 정확하게 감지합니다.
2. 감지된 텍스트 영역을 중심으로 고정 크기(224x224) 패치를 추출합니다.
3. 추출된 패치는 MIL(Multiple Instance Learning) 형태로 구성되어, 패치 그룹이 '가방(Bag)'으로 취급됩니다.
4. MIL의 Bag 레이블은 문서가 다중 작성자(1) 또는 단일 작성자(0)인지 여부입니다.
5. 추출된 패치와 원본 이미지의 관계가 유지되어, 패치가 어떤 작성자의 텍스트를 포함하는지 확인할 수 있습니다.
6. 성능 최적화를 위한 사전 계산 및 캐싱 기능이 구현되어 있습니다.

## 추가 기능 및 고려사항

1. **패치 중복 처리**: 비최대 억제(NMS) 알고리즘을 사용하여 유사한 영역의 중복 패치를 제거합니다.
2. **최소 텍스트 영역 크기**: 너무 작은 텍스트 영역은 무시하여 노이즈를 줄입니다.
3. **패딩 추가**: 텍스트 주변에 패딩을 추가하여 더 많은 맥락을 캡처합니다.
4. **그리드 기반 백업**: 텍스트 영역이 충분히 감지되지 않는 경우 그리드 기반 분할로 대체합니다.
5. **시각화 도구**: 텍스트 감지 결과와 추출된 패치를 시각화하는 기능이 포함되어 있습니다.

## 사용 사례

1. 다중 작성자 식별: 여러 작성자가 참여한 문서를 식별하는 MIL 모델 학습
2. 문서 위조 감지: 작성자 스타일의 비일관성 감지
3. 작성자 영역 분할: 다른 작성자가 작성한 영역 구분

이 코드는 MIL 패러다임과 CRAFT 텍스트 감지의 장점을 결합하여, 핵심 텍스트 영역에 집중함으로써 대용량 문서 이미지에서도 효율적인 학습을 가능하게 합니다. 