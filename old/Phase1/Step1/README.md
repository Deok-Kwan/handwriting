# MIL 데이터셋 분석 도구

## 개요
`mil_dataset_analysis.py`는 Multiple Instance Learning(MIL) 데이터셋의 기본 특성을 파악하고 시각화하는 Python 스크립트입니다. 이 도구는 MIL 데이터셋 구조를 이해하고, 기본 통계 정보를 수집하며, 데이터 샘플을 시각화하는 기능을 제공합니다.

## 목적
- MIL 데이터셋의 폴더 구조 및 파일 구성 파악
- 단일 작성자와 다중 작성자 문서의 분포 확인
- 작성자 통계 및 메타데이터 분석
- 이미지와 마스크 시각화를 통한 데이터 이해

## 주요 기능

### 1. GPU 설정 확인 (`check_gpu`)
- GPU 가용성 확인
- 사용 가능한 GPU 수 및 현재 GPU 정보 출력
- 사용할 장치(cuda:0 또는 CPU) 설정

### 2. 데이터셋 구조 탐색 (`explore_dataset_structure`)
- 주요 디렉토리(`single_author`, `multi_author`, `splits`, `index`, `visualization_results`) 내용 확인
- 단일 작성자 수와 작성자 예시 목록 출력
- 작성자 쌍 수와 예시 출력
- 각 폴더 내 파일 구조 및 개수 확인

### 3. 기본 통계 계산 (`compute_dataset_statistics`)
- 전체 문서 수 확인
- 단일/다중 작성자 문서 비율 계산
- 고유 작성자 수 및 작성자 목록 출력
- 가장 많이 등장하는 작성자 Top 5 확인
- 메타데이터 구조 및 내용 샘플 확인

### 4. 샘플 이미지 및 마스크 시각화 (`visualize_samples`)
- 단일 작성자 문서 샘플 시각화
- 다중 작성자 문서 샘플 시각화
- 이미지와 마스크를 나란히 표시
- 마스크의 고유값 확인

## 사용 방법
```bash
python mil_dataset_analysis.py
```

스크립트를 실행하면 다음 순서로 작업이 진행됩니다:
1. GPU 설정 확인
2. 데이터셋 구조 탐색
3. 기본 통계 계산
4. 샘플 이미지 및 마스크 시각화

## 요구사항
- Python 3.x
- 필수 패키지:
  - NumPy
  - Matplotlib
  - PyTorch
  - OpenCV (cv2)
  - JSON
  - Glob
  - Collections

## 결과 확인
스크립트 실행 시 콘솔에 다음 정보가 출력됩니다:
- GPU 설정 정보
- 데이터셋 구조 및 파일 분포
- 문서 통계 및 작성자 분포
- 메타데이터 구조

또한 Matplotlib을 통해 단일 작성자 및 다중 작성자 문서의 이미지와 마스크가 시각화됩니다.

## 주의사항
- 스크립트 내 `dataset_root` 경로가 올바르게 설정되어 있는지 확인하세요.
- 대용량 데이터셋의 경우 시각화 과정에서 메모리 소비가 클 수 있습니다.
- 한글 폰트가 시스템에 설치되어 있지 않은 경우 시각화 제목에 경고 메시지가 표시될 수 있습니다. 






## 결과 해석


### 데이터셋 구조 분석
- `single_author` 디렉토리는 단일 작성자 문서를 작성자별로 분류하여 저장 
- `multi_author` 디렉토리는 작성자 쌍별로 문서를 관리하여 다중 작성자 분석 지원
- `splits` 디렉토리의 분할 파일은 학습/검증/테스트 세트를 명확히 구분하여 모델 개발 및 평가 지원
- 인덱스 파일은 빠른 데이터 접근을 위한 참조 시스템 제공

### 통계 분석 결과
- 단일 작성자 문서와 다중 작성자 문서의 비율 분석을 통해 데이터셋 균형 파악
- 작성자 분포 분석을 통해 데이터셋의 편향성 확인 가능
- 고유 작성자 수와 등장 빈도는 모델의 일반화 성능에 직접적인 영향을 미침
- 메타데이터 분석을 통해 문서 생성 방식, 시간 정보, 세부 레이블 정보 확인 가능

### 시각화 분석
- 이미지와 마스크의 시각적 비교를 통해 작성자 식별의 시각적 특성 파악
- 마스크의 고유값을 통해 다중 인스턴스 레이블링의 복잡성 확인
- 단일 작성자와 다중 작성자 문서의 시각적 차이점 분석 가능
- 마스크 패턴을 통해 필적 특성 및 작성 영역 구분 가능

### 활용 방안
- 분석 결과를 바탕으로 MIL 모델 설계 시 적절한 하이퍼파라미터 선택 가능
- 데이터셋 불균형이 있을 경우 샘플링 또는 가중치 조정 방법 결정에 활용
- 작성자 분포 정보를 활용하여 다양한 작성자 기반 실험 설계 가능
- 시각화된 마스크 정보를 바탕으로 예측 결과의 해석 및 검증에 활용 